---
title: 企业做项目流程
tags: Projects/Workflow
status: Done
started: 2022-11-03
due:
---
创作时间：2022 年 11 月 3 日
前端学习：第 161 天 
创作打卡：第 9 天
原文链接：[编程导航知识库-用户中心项目笔记](https://bcdh.yuque.com/books/share/2dd2567c-a826-4d9d-9303-bd288269e874/diuioo)
## 企业做项目流程
- 需求分析
- 设计
   - 概要设计
   - 详细设计
- 技术选型
- 初始化/ 引入需要的技术
- 写 Demo
- 写代码，实现业务逻辑
- 测试
   - 单元测试
   - 系统测试
- 代码提交/ 代码评审
- 部署
- 发布上线
## 需求分析
1. 登录/ 注册
2. 用户管理（仅管理员可见）对用户查询或修改
3. 用户校验（仅星球用户可见）
## 技术选型
#### 1. 前端：
- 三件套
- React
- 组件库
- Umi
- Ant Design Pro (现成的管理系统)
#### 2. 后端：
- Java
- Spring (依赖注入框架，管理 Java 对象，集成其他内容)
- SpingMVC (Web 框架，持久层框架)
- MyBatis (Java 操作数据库框架，持久层框架)
- MyBatis-Plus (对 MyBatis 的增强，不用写 SQL 也能实现 CRUD)
- SpringBoot (快速启动/ 快速集成项目，不用自己管理 Spring 配置，不用自己整合各种框架)
- Junit 单元测试库
- MySQL 数据库
#### 3. 部署：服务器/ 容器（平台）
## 初始化方式
.......
## 数据库表设计
有哪些表/模型？表中有哪些字段？字段类型？数据库字段添加索引？表与表之间的关联？
举例：性别是否需要加索引？
### 用户表设计

| id （主键） | bigInt |
| --- | --- |
| userName | varChar |
| userAccount |  |
| avatarUrl (头像) |  |
| gender |  |
| userPassword |  |
| phone |  |
| email |  |
| userStatus |  |
| createTime | datetime |
| updateTime | datetime |
| isDelete | 0/ 1 |
| userRole | 0- 普通用户 1- 管理员 |

### 自动生成器的使用
MyBatisX 插件，自动根据数据库生成：
- domain：实体对象
- mapper: 操作数据库对象
- mapper.xml: 定义了 mapper 对象和数据库的关联，可以在里面自己写 SQL
- service: 包含常用增删改查
- servicelmpl: 具体实现 service
从而提高开发效率！
## 注册逻辑设计
1. 用户在前端输入账户密码、校验密码
2. 校验用户账户、密码、校验密码是否符合要求
   1. 非空
   2. 账户长度不小于 4 位
   3. 密码不小于 8 位
   4. 账户不能重复
   5. 账户不包含特殊字符
   6. 密码和校验密码相同
3. 对密码进行加密（千万不能明文存储到数据库）
4. 向数据库插入用户数据
## 登录功能
### 接口设计
接受参数：用户账户、密码
请求类型：POST
请求体：JSON 格式数据（参数长时不建议用 GET）
返回值：用户信息（脱敏）
### 登录逻辑
1. 校验用户账户和密码是否合法
   1. 非空
   2. 账户长度不小于 4 位
   3. 密码不小于 8 位
   4. 账户不包含特殊字符
2. 校验密码是否输入正确，和数据库中的密文密码对比
3. 用户信息脱敏，隐藏敏感信息。防止数据库中字段泄露
4. 要记录用户的登录态（session）存到服务器上（用后端 SpringBoot 框架封装的服务器 tomcat 去记录）
5. cookie
6. 返回脱敏后的用户信息
### 实现
### 如何知道是哪个用户登录了
## 用户管理
接口设计关键：必须鉴权！
1. 查询用户（允许根据用户名查询）
2. 删除用户
## 写代码流程
1. 先做设计
2. 代码实现
3. 持续优化！！（复用代码、提取公共逻辑/常量）
## 前后端交互
前端需要向后端发送请求才能获取数据，执行操作
### 前端请求库及封装关系
- axios/ umi-request
## 代理
正向代理：替客户端向服务器发送请求，可解决跨域问题
反向代理：替服务器统一接收请求
如何实现代理？
- Nginx
- Node.js
## 后端优化
## 前端优化
### 全局响应处理
应用场景：需要对接口的通用响应进行统一处理，如从 response 中取出 data，或根据 code 去集中处理错误，如用户未登录，无权限等
优势：不用在每个接口请求中都去写相同的逻辑
实现：参考 umi-request/ axios 官方文档
## 多环境
本地环境：localhost (127.0.0.1)
多环境：指同一套代码在不同阶段需要根据实际情况调整配置并部署到不同机器上
#### 1. WHY?
1. 每个环境互不影响
2. 区分不同阶段：开发/测试/生产
3. 对项目优化
#### 2. 分类：
1. 本地环境（自己电脑）
2. 开发环境（远程开发）同连一台机器
3. 测试环境（测试）
4. 预发布环境（体验服）：和正式环境一致，查出更多问题
5. 正式环境（线上，对外公开访问的项目）：尽量不要改动，保证上线前的代码是“完美”运行
6. 沙箱环境（实验环境）：为了做实验
## 项目部署
参考：https://www.bilibili.com/read/cv16179200
### 原始部署
#### 1. 前端：
需要 web 服务器：**nginx**, apache, tomcat
#### 2. 后端
Java, Maven
### 宝塔 Linux 部署
### 前端托管
前端腾讯云 web 应用托管
- 小缺点：需要将代码放到代码托管平台
- 优势：不用写命令、代码更新时自动构建
### Docker 部署
可以将项目环境和项目代码一起打包成镜像，所有同学都能下载镜像，更容易分发移植
### Docker 平台部署
## 绑定域名
#### 1. 前端项目访问流程：
- 用户输入网址
- 域名解析服务器（把网址解析为 IP 地址/交给其他域名解析服务）
- 服务器
- 防火墙
- nginx 接收请求，找到对应文件，返回文件给前端
- 前端加载文件到浏览器中（JS, CSS）
- 渲染页面
#### 2. 后端项目访问流程
- 用户输入网址
- 域名解析服务器（把网址解析为 IP 地址/交给其他域名解析服务）
- 服务器
- nginx 接收请求
- 后端项目（如 8080 端口）
#### 3. nginx 反向代理作用
替服务接收请求，转发请求
## 跨域问题解决
## 项目进一步优化方向
